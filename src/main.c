
#include "wolf3d.h"
#include "../libft/libft.h"
# define mapWidth 24
# define mapHeight 24
int worldMap[mapWidth][mapHeight]=
{
  {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,2,2,2,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,3,0,0,0,3,0,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,0,0,0,5,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
};
void      line(t_mlx m, t_line n, int color)
{
  n.dx = ft_abs(n.x1 - n.x0);
  n.sx = n.x0 < n.x1 ? 1 : -1;
  n.dy = ft_abs(n.y1 - n.y0);
  n.sy = n.y0 < n.y1 ? 1 : -1;
  n.err = (n.dx > n.dy ? n.dx : -n.dy) / 2;
  while (1)
  {
    if (n.x0 == n.x1 && n.y0 == n.y1)
      break ;
    n.e2 = n.err;
    if (n.e2 > -n.dx)
    {
      n.err -= n.dy;
      n.x0 += n.sx;
    }
    if (n.e2 < n.dy)
    {
      n.err += n.dx;
      n.y0 += n.sy;
    }
   // rotate(m, n.x0, n.y0, color);
    mlx_pixel_put(m.mlx, m.win, n.x1, n.y1, color);
  }
}
int		main(void)
{
	t_mlx m;
	t_player p;
	int planedst;
	int rayangle;
	int map[MAPW][MAPH] =
	{0, 0, 0, 0, 0},
	{0, 1, 1, 0, 0},
	{0, 1, 0, 0, 1},
	{0, 0, 0, 0, 0},
	{0, 0, 0, 0, 1};
	s_inter		A;
	int ray;
	int hit;
	p.x = 64 * 2 - 32;
	p.y = 64 * 5 - 32;
	p.view = 90;
	m.mlx = mlx_init();
	m.win = mlx_create_window(m.mlx WINHEIGHT, WINWIDTH, "wolf3D")
  	planedst = (WINDITH / tan(FOV/2));
	rayangle = WIDTH / FOV;
	ray = p.view - (FOV / 2);
	int Ya;
	int Xa;
	while (ray < (FOV / 2 + p.view)) // horizontal intersections
	{
		hit = 0;
		if (ray > 0 && ray < 180)
		{
			A.y = p.y / 64 * (64) - 1;
			Ya = 64;
		}
		else
		{
			A.y = p.y / 64 * (64) + 64;
			Ya = -64;
		}
		Xa = 64/tan(60);
		A.x = p.x + (p.y - A.y) / tan(FOV);
		while (hit < 1)
		{
			A.x = A.x >> 8;
			A.y = A.y >> 8;
			if (map[A.x][A.y] != 0)
			{	
				hit = 1;
				break ;
			}
		A.x = A.x << 8;
		A.y = A.y << 8;
		A.x = A.x + Xa;
		A.y = A.y + Ya;
		}
	ray += rayangel;	
	}
	mlx_loop(m.mlx);

	return (0);
}
